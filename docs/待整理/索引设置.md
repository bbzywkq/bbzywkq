# 索引设置
## 常用的索引动态配置参数
### index.number\_of\_replicas
每个主分片的副本数，默认为1。

### index.auto\_expand\_replicas
该配置项用于控制集群中副本的数量是否随集群中数据节点的数量进行扩展，默认值为false表示副本数不随数据节点扩展。如果希望扩展，可以将值设置为一个数值范围，如“0-3”表示集群中单个主分片的副本数在0个3个之间，具体情况根据集群中数据节点而定，也可以设置为“0-all”，all表示集群中所有的数据集点的数量。

注：

自动扩展的副本数不会考虑到其它对副本分配可能存在的限制规则，如对分片的识别、过滤或每个节点上总分片的限制，如果适用的规则阻止所有副本的分配置，这可能导致群集运行状况变为黄色。

### index.search.idle.after
设置分片多久没有接收过请求，就会被判定为空闲的时间，默认为30秒。

### index.refresh\_interval
执行刷新操作的频率，该操作使索引的最近更改对搜索可见， 默认为1秒， 可以设置为-1表示禁用刷新。

如果显示不设置该值，那些在至少\${index.search.idle.after}秒之前没有收到过搜索请求的分片，将不会收到后台的刷新请求，一直要等这些分片收到搜索才会收到后台的刷新请求，如果当前搜索涉及到操作空闲状态的分片时，刷新操作会被挂起直到下一次后台的刷新操作（1秒之内），此行为旨在在未执行搜索时自动优化默认情况下的批量索引。

如果不希望执行此默认逻辑，应当显示的将刷新时间间隔设置为1秒。

### index.max\_result\_window
对当前索引在被执行搜索时，限制此索引的from + size的最大值，以避免占用过大的堆内存， 默认为10000。

### index.max\_inner\_result\_window
用于控制顶部聚合from+size的总记录，以避免占用过大的堆内存， 默认为100。

### index.max\_rescore\_window
设置索引的rescore请求的window\_size的最大值， 默认为与index.max\_result\_window的值相同，默认值为10000。

### index.max\_docvalue\_fields\_search
查询中允许的最多docvalue\_fields数量，默认为100。Doc\_value字段的查询成本很高，因为它们可能会导致对每个字段和每个文档执行搜索。

### index.max\_script\_fields
查询中允许的最多script\_fields的数量， 默认为32。

### index.max\_ngram\_diff
NGramTokenizer和NGramTokenFilter的min\_gram和max\_gram之间允许的最大差异值，默认为1。

### index.max\_shingle\_diff
ShingleTokenFilter的max\_shingle\_size和min\_shingle\_size之间允许的最大差异值， 默认为3。

### index.blocks.read\_only
控制索引及其元数据是否为只读状态，设置为true表示只读，false为非只读。

### index.blocks.read\_only\_allow\_delete
控制索引及其元数据在只读状态下，是否允许执行删除，设置true表示允许删除，false不允许。

### index.blocks.read
设置是否允许当前索引可读，true表示不可读。

### index.blocks.write
设置是否允许当前索引可写，true表示不可写。与只读read\_only不同的是，它不影响到对元数据的操作。例如可以关闭一个blocks.write的索引，但是不可以关闭一个read\_only状态的索引。

### index.blocks.metadata
控制对metadata的读写，true表示不允许读写。

### index.max\_refresh\_listeners
索引的每个分片上可用的最大刷新侦听器数，这些侦听器用于实现refresh = wait\_for的请求。

### index.analyze.max\_token\_count
使用\_analyze API可以生成的最大词项数， 默认为10000。

### index.highlight.max\_analyzed\_offset
highlight请求可被分析的最大字符数，此设置仅在highlight请求针对没有偏移量或term vector的索引文本时才会生效， 默认为1000000。

### index.max\_terms\_count
可在term查询中使用的最大term数，默认值为65536。

### index.max\_regex\_length
可以在正则表达式查询中使用的正则表达式的最大长度， 默认为1000。

### index.routing.allocation.enable
控制当前索引的分片分配，其值可以设置为：

all（默认值） - 允许所有分片执行分片分配；
primaries - 仅允许为主分片分配分片；
new\_primaries - 仅允许为新创建的主分片分配分片；
none - 不允许执行分片分配；

### index.routing.rebalance.enable
设置索引的分片重新平衡策略，其值可以设置为：

all（默认值） - 允许所有的分片重新平衡；
primaries - 仅允许主分片重新平衡；
replicas - 仅允许对副本分片进行重新平衡；
none - 不允许进行分片重新平衡；

### index.gc\_deletes
设置已删除文档的版本号仍可用于后续版本化操作的时间， 默认为60秒。

