<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="clxbx6O5YYXPaOb.png"><title>Springboot项目 基于gitlab runner 实现CI/CD教程_Honins的博客 | what`s next</title><meta name="description" content="我就想不通了 !">
    <link rel="modulepreload" href="/assets/app.234ff118.js"><link rel="modulepreload" href="/assets/Springboot项目 基于gitlab runner 实现CI CD教程_Honins的博客.html.455860c3.js"><link rel="modulepreload" href="/assets/Springboot项目 基于gitlab runner 实现CI CD教程_Honins的博客.html.eeef960a.js"><link rel="prefetch" href="/assets/index.html.99930f3d.js"><link rel="prefetch" href="/assets/nav.html.086e72f1.js"><link rel="prefetch" href="/assets/演示.html.9859b11a.js"><link rel="prefetch" href="/assets/资源汇总.html.df1972c3.js"><link rel="prefetch" href="/assets/基础.html.d13aa4b0.js"><link rel="prefetch" href="/assets/index.html.7ec162bb.js"><link rel="prefetch" href="/assets/IdeaLearningProject.html.79375511.js"><link rel="prefetch" href="/assets/index.html.7f50e53e.js"><link rel="prefetch" href="/assets/index.html.02ffbeec.js"><link rel="prefetch" href="/assets/index.html.06fec41d.js"><link rel="prefetch" href="/assets/index.html.31d4578b.js"><link rel="prefetch" href="/assets/index.html.38f43525.js"><link rel="prefetch" href="/assets/index.html.8258088c.js"><link rel="prefetch" href="/assets/index.html.a7bec9ae.js"><link rel="prefetch" href="/assets/0_点积.html.de28cf2c.js"><link rel="prefetch" href="/assets/index.html.cd6a45ef.js"><link rel="prefetch" href="/assets/index.html.b91b3f9e.js"><link rel="prefetch" href="/assets/Css.html.b5de4d59.js"><link rel="prefetch" href="/assets/Flex弹性盒子布局.html.90401744.js"><link rel="prefetch" href="/assets/JDK8新特性.html.bf5f92de.js"><link rel="prefetch" href="/assets/LPG日志收集及展示系统.html.d3275eac.js"><link rel="prefetch" href="/assets/LPG运维说明.html.e2d6e29a.js"><link rel="prefetch" href="/assets/MP or查询问题.html.0a34819e.js"><link rel="prefetch" href="/assets/OKR解析.html.268998d3.js"><link rel="prefetch" href="/assets/Pull Request.html.4263b7e8.js"><link rel="prefetch" href="/assets/Python循环结构用法 - 骏马金龙 - 博客园.html.f4a9b2f5.js"><link rel="prefetch" href="/assets/RBAC权限模型.html.3fd7e22d.js"><link rel="prefetch" href="/assets/index.html.49062da0.js"><link rel="prefetch" href="/assets/Sentinel.html.88a9cf08.js"><link rel="prefetch" href="/assets/VScode 常用插件.html.aa43a243.js"><link rel="prefetch" href="/assets/apt安装.html.05421bef.js"><link rel="prefetch" href="/assets/docker资料.html.e03829bd.js"><link rel="prefetch" href="/assets/dubbo实践记录网址.html.ad07e0ec.js"><link rel="prefetch" href="/assets/elk资料.html.5477a857.js"><link rel="prefetch" href="/assets/github初始化存储库.html.37e0a215.js"><link rel="prefetch" href="/assets/jaeger容器化部署.html.7e80ec8b.js"><link rel="prefetch" href="/assets/java泛型.html.d63c8851.js"><link rel="prefetch" href="/assets/jenkins资料.html.d6685eb9.js"><link rel="prefetch" href="/assets/kubernetes资料网址.html.a8d641cb.js"><link rel="prefetch" href="/assets/mybatis association再嵌套association使用问题.html.f0348ffd.js"><link rel="prefetch" href="/assets/mysql账户权限丢失问题.html.00130fca.js"><link rel="prefetch" href="/assets/mysql资料.html.54dc5d81.js"><link rel="prefetch" href="/assets/nacos使用及配置.html.21c44d0e.js"><link rel="prefetch" href="/assets/nacos资料.html.c95b4829.js"><link rel="prefetch" href="/assets/nexus-maven资料.html.4d134326.js"><link rel="prefetch" href="/assets/nginx资料.html.e38748c8.js"><link rel="prefetch" href="/assets/sifari浏览器快捷键.html.215968a1.js"><link rel="prefetch" href="/assets/springcloud资料.html.dd134737.js"><link rel="prefetch" href="/assets/win10配置jdk环境.html.d595267d.js"><link rel="prefetch" href="/assets/win10配置maven环境变量.html.cbf0a37f.js"><link rel="prefetch" href="/assets/win10配置免回环网络验证.html.2e5da472.js"><link rel="prefetch" href="/assets/win10键盘快捷方式.html.8034f88c.js"><link rel="prefetch" href="/assets/yarn.html.9db43697.js"><link rel="prefetch" href="/assets/yum 更新.html.77b29ce7.js"><link rel="prefetch" href="/assets/主从同步配置.html.757c20cb.js"><link rel="prefetch" href="/assets/主机监控项说明.html.e4110447.js"><link rel="prefetch" href="/assets/从服务器基础环境配置到搭建Docker_Gitlab_Gitlab Runner，完整介绍Spring Boot项目的持续集成与持续交付具体实现！   航行学园.html.1f3cc893.js"><link rel="prefetch" href="/assets/全局订阅式蓝绿灰度发布.html.5406b15f.js"><link rel="prefetch" href="/assets/全量配置.html.100cb5b2.js"><link rel="prefetch" href="/assets/全链路版本权重灰度发布.html.7987f6cc.js"><link rel="prefetch" href="/assets/全链路版本条件匹配蓝绿发布.html.775d06c8.js"><link rel="prefetch" href="/assets/全链路版本条件权重灰度发布.html.569b14a8.js"><link rel="prefetch" href="/assets/内网穿透.html.4d040872.js"><link rel="prefetch" href="/assets/分布式事务.html.c19090f3.js"><link rel="prefetch" href="/assets/分布式任务调度.html.48d21946.js"><link rel="prefetch" href="/assets/前端图形框架和游戏引擎.html.4c5f9371.js"><link rel="prefetch" href="/assets/史上最新最全的UI设计面试题汇总 - 知乎.html.bd33edae.js"><link rel="prefetch" href="/assets/启用停止同步.html.f035c6c0.js"><link rel="prefetch" href="/assets/如何发布自己的项目到中央仓库 - 掘金.html.e61c4c7b.js"><link rel="prefetch" href="/assets/密码配置.html.382d0da6.js"><link rel="prefetch" href="/assets/岗位理解.html.999961e1.js"><link rel="prefetch" href="/assets/支付宝与微信二码合一_扫码支付(学习笔记).html.3f09e65f.js"><link rel="prefetch" href="/assets/服务器密码.html.41536f2b.js"><link rel="prefetch" href="/assets/注册Runner.html.220b2dcd.js"><link rel="prefetch" href="/assets/流程.html.4bd47e95.js"><link rel="prefetch" href="/assets/用 Substats 和 Shields.io 为你的个人主页定制动态数据小牌子 - 少数派.html.a1c66351.js"><link rel="prefetch" href="/assets/设计模式.html.79178b1e.js"><link rel="prefetch" href="/assets/证书文件处理.html.92a08a0c.js"><link rel="prefetch" href="/assets/资料.html.f89bdd3d.js"><link rel="prefetch" href="/assets/链接记录.html.8fe86862.js"><link rel="prefetch" href="/assets/集群配置.html.33d424a0.js"><link rel="prefetch" href="/assets/index.html.1d936bf3.js"><link rel="prefetch" href="/assets/index.html.edfac8c4.js"><link rel="prefetch" href="/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/assets/index.html.11e72185.js"><link rel="prefetch" href="/assets/nav.html.5796b082.js"><link rel="prefetch" href="/assets/演示.html.fb25e431.js"><link rel="prefetch" href="/assets/资源汇总.html.4d4edfbc.js"><link rel="prefetch" href="/assets/基础.html.de30e7d3.js"><link rel="prefetch" href="/assets/index.html.4999aa5f.js"><link rel="prefetch" href="/assets/IdeaLearningProject.html.601b5c01.js"><link rel="prefetch" href="/assets/index.html.323b6064.js"><link rel="prefetch" href="/assets/index.html.23d9f2f9.js"><link rel="prefetch" href="/assets/index.html.0842748a.js"><link rel="prefetch" href="/assets/index.html.5febb307.js"><link rel="prefetch" href="/assets/index.html.51bba0ba.js"><link rel="prefetch" href="/assets/index.html.0e0bee64.js"><link rel="prefetch" href="/assets/index.html.77395f14.js"><link rel="prefetch" href="/assets/0_点积.html.098764d0.js"><link rel="prefetch" href="/assets/index.html.e5a945e5.js"><link rel="prefetch" href="/assets/index.html.29b1a632.js"><link rel="prefetch" href="/assets/Css.html.7a01d9a6.js"><link rel="prefetch" href="/assets/Flex弹性盒子布局.html.588bb471.js"><link rel="prefetch" href="/assets/JDK8新特性.html.32b48ac4.js"><link rel="prefetch" href="/assets/LPG日志收集及展示系统.html.57eb66f0.js"><link rel="prefetch" href="/assets/LPG运维说明.html.29c7cb35.js"><link rel="prefetch" href="/assets/MP or查询问题.html.0210709e.js"><link rel="prefetch" href="/assets/OKR解析.html.8d6db38b.js"><link rel="prefetch" href="/assets/Pull Request.html.55203edc.js"><link rel="prefetch" href="/assets/Python循环结构用法 - 骏马金龙 - 博客园.html.8b038a44.js"><link rel="prefetch" href="/assets/RBAC权限模型.html.ea5c9f29.js"><link rel="prefetch" href="/assets/index.html.a90e4919.js"><link rel="prefetch" href="/assets/Sentinel.html.9c8a828d.js"><link rel="prefetch" href="/assets/VScode 常用插件.html.0c87a205.js"><link rel="prefetch" href="/assets/apt安装.html.5d5711a5.js"><link rel="prefetch" href="/assets/docker资料.html.0d83cd85.js"><link rel="prefetch" href="/assets/dubbo实践记录网址.html.cdc4c3d2.js"><link rel="prefetch" href="/assets/elk资料.html.23e2db8e.js"><link rel="prefetch" href="/assets/github初始化存储库.html.6578cfdb.js"><link rel="prefetch" href="/assets/jaeger容器化部署.html.7f7ed6f7.js"><link rel="prefetch" href="/assets/java泛型.html.d121210a.js"><link rel="prefetch" href="/assets/jenkins资料.html.c8b1b503.js"><link rel="prefetch" href="/assets/kubernetes资料网址.html.cfb88266.js"><link rel="prefetch" href="/assets/mybatis association再嵌套association使用问题.html.962eff69.js"><link rel="prefetch" href="/assets/mysql账户权限丢失问题.html.35e5d851.js"><link rel="prefetch" href="/assets/mysql资料.html.92503fd1.js"><link rel="prefetch" href="/assets/nacos使用及配置.html.57df790f.js"><link rel="prefetch" href="/assets/nacos资料.html.fdfb8b26.js"><link rel="prefetch" href="/assets/nexus-maven资料.html.967199c3.js"><link rel="prefetch" href="/assets/nginx资料.html.a0b658d0.js"><link rel="prefetch" href="/assets/sifari浏览器快捷键.html.3fa0749e.js"><link rel="prefetch" href="/assets/springcloud资料.html.f4158083.js"><link rel="prefetch" href="/assets/win10配置jdk环境.html.f5b3feef.js"><link rel="prefetch" href="/assets/win10配置maven环境变量.html.2a577416.js"><link rel="prefetch" href="/assets/win10配置免回环网络验证.html.62d7ac9f.js"><link rel="prefetch" href="/assets/win10键盘快捷方式.html.2b77c83c.js"><link rel="prefetch" href="/assets/yarn.html.1c0b2711.js"><link rel="prefetch" href="/assets/yum 更新.html.b7655a9b.js"><link rel="prefetch" href="/assets/主从同步配置.html.926eab88.js"><link rel="prefetch" href="/assets/主机监控项说明.html.266dc680.js"><link rel="prefetch" href="/assets/从服务器基础环境配置到搭建Docker_Gitlab_Gitlab Runner，完整介绍Spring Boot项目的持续集成与持续交付具体实现！   航行学园.html.38209853.js"><link rel="prefetch" href="/assets/全局订阅式蓝绿灰度发布.html.2554a015.js"><link rel="prefetch" href="/assets/全量配置.html.1af1d512.js"><link rel="prefetch" href="/assets/全链路版本权重灰度发布.html.dddc0598.js"><link rel="prefetch" href="/assets/全链路版本条件匹配蓝绿发布.html.ade99ae5.js"><link rel="prefetch" href="/assets/全链路版本条件权重灰度发布.html.724897f0.js"><link rel="prefetch" href="/assets/内网穿透.html.988a57ef.js"><link rel="prefetch" href="/assets/分布式事务.html.58f26960.js"><link rel="prefetch" href="/assets/分布式任务调度.html.c1d4dcec.js"><link rel="prefetch" href="/assets/前端图形框架和游戏引擎.html.8419bcc5.js"><link rel="prefetch" href="/assets/史上最新最全的UI设计面试题汇总 - 知乎.html.c239f669.js"><link rel="prefetch" href="/assets/启用停止同步.html.cf29ddcd.js"><link rel="prefetch" href="/assets/如何发布自己的项目到中央仓库 - 掘金.html.ed89250f.js"><link rel="prefetch" href="/assets/密码配置.html.23d1ab0b.js"><link rel="prefetch" href="/assets/岗位理解.html.7649da79.js"><link rel="prefetch" href="/assets/支付宝与微信二码合一_扫码支付(学习笔记).html.085369a7.js"><link rel="prefetch" href="/assets/服务器密码.html.b9047177.js"><link rel="prefetch" href="/assets/注册Runner.html.76d75eff.js"><link rel="prefetch" href="/assets/流程.html.88953993.js"><link rel="prefetch" href="/assets/用 Substats 和 Shields.io 为你的个人主页定制动态数据小牌子 - 少数派.html.831e916e.js"><link rel="prefetch" href="/assets/设计模式.html.91d272a0.js"><link rel="prefetch" href="/assets/证书文件处理.html.01138281.js"><link rel="prefetch" href="/assets/资料.html.ebb2b949.js"><link rel="prefetch" href="/assets/链接记录.html.1e8f9a98.js"><link rel="prefetch" href="/assets/集群配置.html.7245a665.js"><link rel="prefetch" href="/assets/index.html.d3b6d760.js"><link rel="prefetch" href="/assets/index.html.ae115c03.js"><link rel="prefetch" href="/assets/404.html.fc539429.js">
    <link rel="stylesheet" href="/assets/style.96ee71b5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">what`s next</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="检索"><span class="title">检索</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="检索"><span class="title">检索</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://www.google.com" rel="noopener noreferrer" target="_blank" aria-label="google"><!--[--><!--]--> google <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://yandex.com/" rel="noopener noreferrer" target="_blank" aria-label="yandex"><!--[--><!--]--> yandex <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/bbzywkq/bbzywkq.github.io/tree/main/docs" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="检索"><span class="title">检索</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="检索"><span class="title">检索</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://www.google.com" rel="noopener noreferrer" target="_blank" aria-label="google"><!--[--><!--]--> google <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://yandex.com/" rel="noopener noreferrer" target="_blank" aria-label="yandex"><!--[--><!--]--> yandex <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/bbzywkq/bbzywkq.github.io/tree/main/docs" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Springboot项目 基于gitlab runner 实现CI/CD教程_Honins的博客 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#ci-是什么-ci-和-cd-有什么区别" class="router-link-active router-link-exact-active sidebar-item" aria-label="CI 是什么？CI 和 CD 有什么区别？"><!--[--><!--]--> CI 是什么？CI 和 CD 有什么区别？ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#理想的ci-cd开发流应该是怎样的" class="router-link-active router-link-exact-active sidebar-item" aria-label="理想的CI/CD开发流应该是怎样的？"><!--[--><!--]--> 理想的CI/CD开发流应该是怎样的？ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#_1-gitlab-runner安装并注册" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Gitlab-Runner安装并注册"><!--[--><!--]--> 1. Gitlab-Runner安装并注册 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#_2-免密登陆" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. 免密登陆"><!--[--><!--]--> 2. 免密登陆 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#为什么需要免密登录" class="router-link-active router-link-exact-active sidebar-item" aria-label="为什么需要免密登录？"><!--[--><!--]--> 为什么需要免密登录？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#生成一对公私钥" class="router-link-active router-link-exact-active sidebar-item" aria-label="生成一对公私钥"><!--[--><!--]--> 生成一对公私钥 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#定义ssh-config内容" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义ssh config内容"><!--[--><!--]--> 定义ssh config内容 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#免密登录" class="router-link-active router-link-exact-active sidebar-item" aria-label="免密登录"><!--[--><!--]--> 免密登录 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#验证登录" class="router-link-active router-link-exact-active sidebar-item" aria-label="验证登录"><!--[--><!--]--> 验证登录 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#_3-gitlab上定义ssh配置信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.gitlab上定义ssh配置信息"><!--[--><!--]--> 3.gitlab上定义ssh配置信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#_4-使用rsync传输应用文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. 使用rsync传输应用文件"><!--[--><!--]--> 4. 使用rsync传输应用文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#_5-启动项目" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. 启动项目"><!--[--><!--]--> 5. 启动项目 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#完整的ci脚本-以doctor端为例" class="router-link-active router-link-exact-active sidebar-item" aria-label="完整的ci脚本（以doctor端为例）"><!--[--><!--]--> 完整的ci脚本（以doctor端为例） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#遇到的问题" class="router-link-active router-link-exact-active sidebar-item" aria-label="遇到的问题"><!--[--><!--]--> 遇到的问题 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#使用ssh连接启动项目报错-mnv-未找到命令" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用ssh连接启动项目报错 mnv: 未找到命令"><!--[--><!--]--> 使用ssh连接启动项目报错 mnv: 未找到命令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#rsync-命令未定义" class="router-link-active router-link-exact-active sidebar-item" aria-label="rsync 命令未定义"><!--[--><!--]--> rsync 命令未定义 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/%E5%BE%85%E6%95%B4%E7%90%86/Springboot%E9%A1%B9%E7%9B%AE%20%E5%9F%BA%E4%BA%8Egitlab%20runner%20%E5%AE%9E%E7%8E%B0CI%20CD%E6%95%99%E7%A8%8B_Honins%E7%9A%84%E5%8D%9A%E5%AE%A2.html#rsync报错-code-255" class="router-link-active router-link-exact-active sidebar-item" aria-label="rsync报错 code 255"><!--[--><!--]--> rsync报错 code 255 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="springboot项目-基于gitlab-runner-实现ci-cd教程-honins的博客" tabindex="-1"><a class="header-anchor" href="#springboot项目-基于gitlab-runner-实现ci-cd教程-honins的博客" aria-hidden="true">#</a> Springboot项目 基于gitlab runner 实现CI/CD教程_Honins的博客</h1><h1 id="java项目-ci-cd的实现教程" tabindex="-1"><a class="header-anchor" href="#java项目-ci-cd的实现教程" aria-hidden="true">#</a> Java项目 CI/CD的实现教程</h1><h2 id="ci-是什么-ci-和-cd-有什么区别" tabindex="-1"><a class="header-anchor" href="#ci-是什么-ci-和-cd-有什么区别" aria-hidden="true">#</a> CI 是什么？CI 和 CD 有什么区别？</h2><p>缩略词 CI / CD 具有几个不同的含义。CI/CD 中的“CI”始终指持续集成，它属于开发人员的自动化流程。成功的 CI 意味着应用代码的新更改会定期构建、测试并合并到共享存储库中。该解决方案可以解决在一次开发中有太多应用分支，从而导致相互冲突的问题。</p><p>CI/CD 中的“CD”指的是持续交付和/或持续部署，这些相关概念有时会交叉使用。两者都事关管道后续阶段的自动化，但它们有时也会单独使用，用于说明自动化程度。</p><p>持续_交付_通常是指开发人员对应用的更改会自动进行错误测试并上传到存储库（如 <a href="https://redhatofficial.github.io/#!/main" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 或容器注册表），然后由运维团队将其部署到实时生产环境中。这旨在解决开发和运维团队之间可见性及沟通较差的问题。因此，持续交付的目的就是确保尽可能减少部署新代码时所需的工作量。</p><p>持续_部署_（另一种“CD”）指的是自动将开发人员的更改从存储库发布到生产环境，以供客户使用。它主要为了解决因手动流程降低应用交付速度，从而使运维团队超负荷的问题。持续部署以持续交付的优势为根基，实现了管道后续阶段的自动化。</p><p><img src="https://file.bbzy.online/blog/0976542b43ef7844e921c22cf3063373.png" alt="image"></p><p>CI/CD 既可能仅指持续集成和持续交付构成的关联环节，也可以指持续集成、持续交付和持续部署这三项构成的关联环节。更为复杂的是，有时“持续交付”也包含了持续部署流程。</p><p>归根结底，我们没必要纠结于这些语义，您只需记得 CI/CD 其实就是一个流程（通常形象地表述为管道），用于实现应用开发中的高度持续自动化和持续监控。因案例而异，该术语的具体含义取决于 CI/CD 管道的自动化程度。许多企业最开始先添加 CI，然后逐步实现交付和部署的自动化（例如作为<a href="https://www.redhat.com/zh/topics/cloud-native-apps" target="_blank" rel="noopener noreferrer">云原生应用<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>的一部分）。</p><p>来自于RadHat:https://www.redhat.com/zh/topics/devops/what-is-ci-cd，更多内容可查看此文档。</p><p>以一言概之的话我想应该是：机械的事情让机器做。一个开发团队，没有CI/CD，可能是这样子的：无法管理代码多人多地协作（git repository也是CI的一部分），系列的shell需要人工处理，代码的发布需要登录服务器等等；相反，拥有CI/CD，这些事情都交给机器去完成，减少人工操作出错的概率，腾出的碎片时间还可以去做更有意义的事情。</p><h3 id="理想的ci-cd开发流应该是怎样的" tabindex="-1"><a class="header-anchor" href="#理想的ci-cd开发流应该是怎样的" aria-hidden="true">#</a> 理想的CI/CD开发流应该是怎样的？</h3><p>我认为理想的CI/CD开发流应该包含三个阶段：<code>build</code>、<code>deploy</code>和<code>notify</code>。build阶段专注做代码构建与单元测试，deploy阶段专注做test/gray/prod环境的代码部署，notify阶段专注做上线通知，如下图;</p><p><img src="https://file.bbzy.online/blog/f7cfbcfa77326a7a100af662f74e8763.png" alt="image"></p><p>以下内容围绕build和deploy两个阶段完成从<strong>0到1的部署</strong>。<strong>（不包括合并分支，以医易网 app端为例）</strong></p><h2 id="_1-gitlab-runner安装并注册" tabindex="-1"><a class="header-anchor" href="#_1-gitlab-runner安装并注册" aria-hidden="true">#</a> 1. Gitlab-Runner安装并注册</h2><p>我这里使用的是Gitlab-Runner，文档：https://docs.gitlab.com/runner/</p><h2 id="_2-免密登陆" tabindex="-1"><a class="header-anchor" href="#_2-免密登陆" aria-hidden="true">#</a> 2. 免密登陆</h2><h3 id="为什么需要免密登录" tabindex="-1"><a class="header-anchor" href="#为什么需要免密登录" aria-hidden="true">#</a> 为什么需要免密登录？</h3><ul><li>构建产出的dist文件要传输到目标服务器（测试机/生成机），要么基于http网络协议、要么基于ssh协议（或其他文件传输协议？）</li><li>基于http需要写文件接收接口，这里直接使用基于ssh传输文件的<code>rsync</code>，简单、安全！</li><li>runner内定义的一系列script是在一个docker容器内执行的，无法人工干预，那么登录服务器就要做成免密。</li></ul><p>先在本机（注册runner所在的机器）配一遍免密登录服务器的流程：</p><h3 id="生成一对公私钥" tabindex="-1"><a class="header-anchor" href="#生成一对公私钥" aria-hidden="true">#</a> 生成一对公私钥</h3><p>使用rsa作为非对称加密方式：</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>ssh-keygen
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>说明</strong>：命令会在<code>~/.ssh</code>目录下生产公钥私钥</p><h3 id="定义ssh-config内容" tabindex="-1"><a class="header-anchor" href="#定义ssh-config内容" aria-hidden="true">#</a> 定义ssh config内容</h3><p>在~/.ssh/config文件写入以下内容（文件不存在直接创建）：</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>Host any_name
  HostName server_ip
  User user
  IdentityFile ~/.ssh/id_rsa
1234
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>多个Host可以这么写：</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>Host lyg-dev
    Port 22
    HostName ip
    User root
    IdentityFile ~/.ssh/id_rsa

Host project-dev
    Port 22
      HostName ip 
      User root
      IdentityFile ~/.ssh/id_rsa

123456789101112
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>说明</strong>：定义ssh的config文件是为了快捷访问，就像你配置host一样，没有hostname，你只能访问ip。配置后你就可以通过 <code>ssh any_name</code> 登录服务器了。当然，不出意外，会要求你输入服务器的登录密码。</p><h3 id="免密登录" tabindex="-1"><a class="header-anchor" href="#免密登录" aria-hidden="true">#</a> 免密登录</h3><p>免密登录的精髓就是：把本机的公钥存储到目标服务器的authorized_keys文件内（该文件服务器上不存在可以直接创建。）</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>ssh-copy-id -i ~/.ssh/id_rsa.pub username@ip
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>特别地</strong>：如果你的端口不是默认的22端口，则加上端口号 <code>-p PORT</code></p><h3 id="验证登录" tabindex="-1"><a class="header-anchor" href="#验证登录" aria-hidden="true">#</a> 验证登录</h3><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>ssh any_name
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>不出意外，你应该可以直接登录服务器了。那么，我们回到gitlab的配置上</p><h2 id="_3-gitlab上定义ssh配置信息" tabindex="-1"><a class="header-anchor" href="#_3-gitlab上定义ssh配置信息" aria-hidden="true">#</a> 3.gitlab上定义ssh配置信息</h2><p>我们进入gitlab页面位置：Settings &gt;&gt; CI/CD &gt;&gt; Environment variables下定义 <code>.gitlab.yml</code> 上出现的几个变量：</p><p><img src="https://file.bbzy.online/blog/dbcce0ea4be7e1498f815886d1ef6247.png" alt="image"></p><ul><li><code>SSH_PRIVATE_KEY</code>：把本机（runner所在机器）的私钥复制过来：~/.ssh/id_rsa</li><li><code>SSH_CONFIG</code>：把刚才ssh config定义的信息复制过来：~/.ssh/config</li><li>SSH_KNOWN_HOST`：定义这个变量是为了让ssh对服务器进行身份确认（不然会被ssh认为是一个不被信任的环境），变量值使用以下命令生成：</li></ul><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>ssh-keyscan -p PORT IP
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>然后打开<code>~/.ssh/known_hosts</code>，将次ip对应的内容存至SSH_KNOWN_HOST</p><p><img src="https://file.bbzy.online/blog/f39e0e26c71056fefa12a9e939e6c11c.png" alt="image"></p><p><code>SSH_USER</code> <code>SSH_HOST_DEV</code> 这两个值可选。</p><h2 id="_4-使用rsync传输应用文件" tabindex="-1"><a class="header-anchor" href="#_4-使用rsync传输应用文件" aria-hidden="true">#</a> 4. 使用rsync传输应用文件</h2><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>rsync -rve ssh target/app.jar root@project-dev:/project/code/project/app/app
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>说明</strong>：<code>project-dev</code>就是在<code>ssh config</code>定义的<code>Host</code>值。</p><h2 id="_5-启动项目" tabindex="-1"><a class="header-anchor" href="#_5-启动项目" aria-hidden="true">#</a> 5. 启动项目</h2><p>以下命令用于测试环境，正式医易网环境需要判断旧版本项目和端口等，较复杂，暂时不写。</p><p>使用SSH远程连接服务器，进入相应目录，然后执行<code>shutdown.sh</code>和<code>startup-jar.sh</code>。注意是startup-jar</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>    ssh -o StrictHostKeyChecking=no -T project-dev &quot;cd /project/code/project/ &amp;&amp; sh shutdown.sh app&quot;
    ssh -o StrictHostKeyChecking=no -T project-dev &quot;source /etc/profile &amp;&amp; cd /project/code/project/ &amp;&amp; sh startup-jar.sh app&quot;
12
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="完整的ci脚本-以doctor端为例" tabindex="-1"><a class="header-anchor" href="#完整的ci脚本-以doctor端为例" aria-hidden="true">#</a> 完整的ci脚本（以doctor端为例）</h2><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>image: java:8

stages:
  - package
  - build

services:
  - docker:dind

#目前只需要jar包这个资产，依赖在宿主机上，不需要这个cache
#cache:
# key: push-maven
# paths:
#   - /root/.m2/
#   - target/*.jar

maven-package:
  image: maven:3.6.3-jdk-8
  stage: package
  script:
    - echo &quot;===============目录结构  ===============&quot; `ls`
    - echo &quot;=============== 开始编译源码，包含单元测试，在target目录生成jar文件 ===============&quot;
    - mvn clean install
    - echo &quot;target文件夹&quot; `ls target/`
  artifacts:
    paths:
      - target/*.jar

build-deploy-docker-dev:
  image: docker:latest
  stage: build
  environment: dev
  only:
    - master
  before_script:
    - echo &quot;=============== 测试环境 ===============&quot;
    - echo &quot;=====换阿里镜像源=====&quot;
    - sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#39; /etc/apk/repositories
    - echo &quot;=====安装 ssh=====&quot;
    - which ssh-agent || ( apk update &amp;&amp; apk --no-cache add openssh-client )
    - echo &quot;=====配置 ssh 文件=====&quot;
    - mkdir -p ~/.ssh
    - cp ${SSH_PRIVATE_KEY}  ~/.ssh/id_rsa
    - chmod 700 ~/.ssh/id_rsa
    - cp ${SSH_CONFIG}  ~/.ssh/config
    - cat /etc/*-release
    - echo &quot;=====安装 rsync=====&quot;
    - command -v rsync || (apk update &amp;&amp; apk --no-cache add rsync)
  script:
    - echo &quot;===== 从缓存中恢复的target文件夹 =====&quot;
    - ls target/
    - echo &quot;===== 替换文件名，方便后续发布 =====&quot;
    - mv target/app*.jar target/app.jar
    - ssh -o StrictHostKeyChecking=no -T project-dev &quot;cd /project/code/project/ &amp;&amp; sh shutdown.sh app&quot;
    - rsync -rve ssh target/app.jar root@project-dev:/project/code/project/app/app
    - ssh -o StrictHostKeyChecking=no -T project-dev &quot;source /etc/profile &amp;&amp; cd /project/code/project/ &amp;&amp; sh startup-jar.sh app&quot;

build-deploy-docker-pro:
  image: docker:latest
  stage: build
  environment: work
  only:
    - release
  script:
    - echo &quot;&quot;=============== 生产环境 &quot;===============&quot;
    - echo &quot;从缓存中恢复的target文件夹&quot; `ls target/`
    - echo &quot;todo ...&quot;

1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="遇到的问题" tabindex="-1"><a class="header-anchor" href="#遇到的问题" aria-hidden="true">#</a> 遇到的问题</h2><h3 id="使用ssh连接启动项目报错-mnv-未找到命令" tabindex="-1"><a class="header-anchor" href="#使用ssh连接启动项目报错-mnv-未找到命令" aria-hidden="true">#</a> 使用ssh连接启动项目报错 mnv: 未找到命令</h3><p>在这篇文章里得到了解答：https://blog.csdn.net/nklinsirui/article/details/104673286/?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&amp;spm=1001.2101.3001.4242</p><p>文末给出了2种解决办法，用方法二方便点，于是执行命令可以写成</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>ssh -o StrictHostKeyChecking=no -T project-dev &quot;source /etc/profile &amp;&amp; cd /project/code/project/ &amp;&amp; bash startup.sh app&quot;
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rsync-命令未定义" tabindex="-1"><a class="header-anchor" href="#rsync-命令未定义" aria-hidden="true">#</a> rsync 命令未定义</h3><p>这个问题的原因是：我们的gitlab-runner使用的系统是alpine linux，是一个非常精简版的linux系统，没有安装rsync工具，需要手动安装。</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>apk update &amp;&amp; apk --no-cache add rsync
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>又由于网络原因，直接安装失败，先需要更换镜像源，可以使用阿里源</p><div class="language-Plain ext-Plain line-numbers-mode"><pre class="language-Plain"><code>sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#39; /etc/apk/repositories
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rsync报错-code-255" tabindex="-1"><a class="header-anchor" href="#rsync报错-code-255" aria-hidden="true">#</a> rsync报错 code 255</h3><p>ssh验证失败。网上也有人遇到这个问题：https://bobcares.com/blog/rsync-error-code-255/</p><p>但是按照文中说的方法，仍然报这个错误。</p><p>我尝试替换命令顺序，把ssh连接放到前面，然后运行rsync，可正常执行。</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/bbzywkq/bbzywkq.github.io/edit/main/docs/待整理/Springboot项目 基于gitlab runner 实现CI CD教程_Honins的博客.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">编辑者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: bbzykkall@gmail.com">bbzy alone</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.234ff118.js" defer></script>
  </body>
</html>
